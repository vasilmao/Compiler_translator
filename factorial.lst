     1                                  input:
     2 00000000 4D31C0                  xor r8, r8 ; answer
     3 00000003 4D31C9                  xor r9, r9 ; helper
     4                                  InputLoop:
     5 00000006 4831C0                  xor rax, rax
     6 00000009 BF00000000              mov rdi, 0
     7 0000000E 48BE-                   mov rsi, InBuffer
     7 00000010 [0000000000000000] 
     8 00000018 BA01000000              mov rdx, 1
     9 0000001D 0F05                    syscall
    10 0000001F 448A1425[00000000]      mov r10b, byte [InBuffer]
    11 00000027 4983FA30                cmp r10, '0'
    12 0000002B 7C1C                    jl InputLoopExit
    13 0000002D 4983FA39                cmp r10, '9'
    14 00000031 7716                    ja InputLoopExit
    15 00000033 4983EA30                sub r10, '0'
    16 00000037 4D89C1                  mov r9, r8
    17 0000003A 49C1E003                shl r8, 3
    18 0000003E 49D1E1                  shl r9, 1
    19 00000041 4D01C8                  add r8, r9
    20 00000044 4D01D0                  add r8, r10
    21                                  ;push r10
    22 00000047 EBBD                    jmp InputLoop
    23                                  ; need: r8 = r8 * 10
    24                                  InputLoopExit:
    25 00000049 4C89C0                  mov rax, r8
    26 0000004C C3                      ret
    27                                  
    28                                  print:
    29 0000004D 488B442408              mov rax, qword [rsp + 8]
    30 00000052 BB0A000000              mov rbx, 10
    31 00000057 4831D2                      xor rdx, rdx
    32 0000005A 4831FF                      xor rdi, rdi ; counter
    33                                  	StackNumLoop:
    34 0000005D 48F7F3                          div rbx ; rax = res, rdx = mod
    35 00000060 52                      		push rdx
    36 00000061 48FFC7                  		inc rdi
    37 00000064 4831D2                  		xor rdx, rdx
    38 00000067 4883F800                		cmp rax, 0
    39 0000006B 75F0                    		jne StackNumLoop
    40 0000006D 4831C9                      xor rcx, rcx
    41                                  	BuffNumLoop:
    42 00000070 58                      		pop rax
    43                                          ;call WriteDigitToBuffer
    44 00000071 4883C030                        add rax, '0'
    45 00000075 488981[01000000]                mov [OutBuffer + rcx], rax
    46 0000007C 48FFC1                          inc rcx
    47 0000007F 66FFCF                  		dec di
    48 00000082 6683FF00                		cmp di, 0
    49 00000086 75E8                    		jne BuffNumLoop
    50 00000088 B801000000                  mov rax, 1
    51 0000008D BF01000000                  mov rdi, 1
    52 00000092 48BE-                       mov rsi, OutBuffer
    52 00000094 [0100000000000000] 
    53 0000009C 4889CA                      mov rdx, rcx
    54 0000009F 0F05                        syscall
    55 000000A1 B801000000                  mov rax, 1
    56 000000A6 BF01000000                  mov rdi, 1
    57 000000AB 48BE-                       mov rsi, NextLine
    57 000000AD [1400000000000000] 
    58 000000B5 BA01000000                  mov rdx, 1
    59 000000BA 0F05                        syscall
    60 000000BC C3                      	ret
    61                                  
    62                                  section .data
    63 00000000 00                      InBuffer: db 0
    64 00000001 00<rep 13h>             OutBuffer: times 19 db 0
    65 00000014 0A                      NextLine: db 0x0a
    66                                  section .text
    67                                  global _start
    68                                  _start:
    69 000000BD 4883EC08                sub rsp, 8
    70 000000C1 4889E5                  mov rbp, rsp
    71 000000C4 EB64                    jmp factorial_END
    72                                  factorial:
    73 000000C6 4889E5                  mov rbp, rsp
    74 000000C9 4883C508                add rbp, 8 ; this was fdecl
    75 000000CD 488B4500                mov rax, [rbp + 0] ; this was name
    76 000000D1 50                      push rax
    77 000000D2 B801000000              mov rax, 1 ; var = const 0x56408acf6b50
    78 000000D7 5B                      pop rbx
    79 000000D8 4893                    xchg rax, rbx
    80 000000DA 4831D2                  xor rdx, rdx
    81 000000DD 4839D8                  cmp rax, rbx
    82 000000E0 0F9EC0                  setle al
    83 000000E3 4831DB                  xor rbx, rbx
    84 000000E6 88C3                    mov bl, al
    85 000000E8 4831C0                  xor rax, rax
    86 000000EB 88D8                    mov al, bl
    87 000000ED 4883F800                cmp rax, 0
    88 000000F1 7406                    je LNOT0x56408acf6c40 ; this is condition start
    89 000000F3 B801000000              mov rax, 1 ; var = const 0x56408acf6be0
    90 000000F8 C3                      ret ; thats it
    91                                  LNOT0x56408acf6c40:
    92 000000F9 90                      nop
    93 000000FA 90                      nop ; condition end
    94 000000FB 488B4500                mov rax, [rbp + 0] ; this was name
    95 000000FF 50                      push rax
    96 00000100 55                      push rbp ; save rbp before call
    97 00000101 488B4500                mov rax, [rbp + 0] ; this was name
    98 00000105 50                      push rax
    99 00000106 B801000000              mov rax, 1 ; var = const 0x56408acf6f50
   100 0000010B 5B                      pop rbx
   101 0000010C 4893                    xchg rax, rbx
   102 0000010E 4831D2                  xor rdx, rdx
   103 00000111 4829D8                  sub rax, rbx
   104 00000114 50                      push rax ; this was argument passing
   105 00000115 E8ACFFFFFF              call factorial ; the call
   106 0000011A 4883C408                add rsp, 8
   107 0000011E 5D                      pop rbp ; after call
   108 0000011F 5B                      pop rbx
   109 00000120 4893                    xchg rax, rbx
   110 00000122 4831D2                  xor rdx, rdx
   111 00000125 48F7E3                  mul rbx
   112 00000128 C3                      ret ; thats it
   113 00000129 C3                      ret
   114                                  factorial_END:
   115 0000012A 55                      push rbp ; save rbp before call
   116 0000012B E8D0FEFFFF              call input ; the call
   117 00000130 4883C400                add rsp, 0
   118 00000134 5D                      pop rbp ; after call
   119 00000135 48894500                mov [rbp + 0], rax ;this was var decl
   120 00000139 55                      push rbp ; save rbp before call
   121 0000013A 55                      push rbp ; save rbp before call
   122 0000013B 488B4500                mov rax, [rbp + 0] ; this was name
   123 0000013F 50                      push rax ; this was argument passing
   124 00000140 E881FFFFFF              call factorial ; the call
   125 00000145 4883C408                add rsp, 8
   126 00000149 5D                      pop rbp ; after call
   127 0000014A 50                      push rax ; this was argument passing
   128 0000014B E8FDFEFFFF              call print ; the call
   129 00000150 4883C408                add rsp, 8
   130 00000154 5D                      pop rbp ; after call
   131 00000155 4883C408                add rsp, 8
   132 00000159 B83C000000              mov rax, 0x3C
   133 0000015E 4831FF                  xor rdi, rdi
   134 00000161 0F05                    syscall
